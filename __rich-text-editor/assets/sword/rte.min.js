/*! Taufik Nurrohman <http://latitudu.com> (2016-05-22) */
!function(e){for(var t=document,n=e.commands,a=["Left","Center","Right","Justify"],r=0,i=a.length;i>r;++r)n["align"+a[r]]=function(){var e={className:"text-"+a[r].toLowerCase(),classRegExp:/text-[a-z0-9]+/g,toggle:!0};return{exec:function(t){return n.formatBlock.exec(t,"formatBlock",e)},state:function(t){return n.formatBlock.state(t,"formatBlock",e)}}}();var o={bold:"STRONG",italic:"EM",underline:"U",strike:"DEL",time:"TIME",code:"CODE",mark:"MARK",sup:"SUP",sub:"SUB"};for(var r in o)n[r]=function(){var e={nodeName:o[r],attribute:{},toggle:!0};return{exec:function(t,a){if(a.match(/^del|ins|strike|time$/)){var r=new Date,i=+r.getFullYear(),o=+r.getMonth()+1,l=+r.getDate();10>o&&(o="0"+o),10>l&&(l="0"+l),e.attribute.datetime=i+"-"+o+"-"+l}n.formatInline.exec(t,a,e)},state:function(t,a){return n.formatInline.state(t,a,e)}}}(),n.pre=function(){return{exec:function(t,n,a){var r,i,o,l=this.state(t)[0];l?t.selection.executeAndRestore(function(){r=l.querySelector("code"),e.dom.replaceWithChildNodes(l),r&&e.dom.replaceWithChildNodes(r)}):(i=t.selection.getRange(),o=i.extractContents(),l=t.doc.createElement("PRE"),r=t.doc.createElement("CODE"),a&&(r.className=a),l.appendChild(r),r.appendChild(o),i.insertNode(l),t.selection.selectNode(l))},state:function(t){var n,a=t.selection.getSelectedNode();return a&&a.nodeName&&"PRE"==a.nodeName&&a.firstChild&&a.firstChild.nodeName&&"CODE"==a.firstChild.nodeName?[a]:(n=e.dom.getParentElement(a,{query:"pre code"}),n?[n.parentNode]:!1)}}}(),n.quote=function(){var e={nodeName:"BLOCKQUOTE",toggle:!0};return{exec:function(t){return n.formatBlock.exec(t,"formatBlock",e)},state:function(t){return n.formatBlock.state(t,"formatBlock",e)}}}(),n.horizontal=function(){return{exec:function(t){var n,a,r=t.selection.getSelectedNode();(r=e.dom.getParentElement(r,{query:"*"},null,t.editableArea))?(n=t.doc.createElement("HR"),t.selection.splitElementAtCaret(r,n),t.selection.selectNode(n.nextSibling||n),a=t.selection.getSelection(),a.collapseToStart()):t.selection.insertHTML("<hr>")}}}(),n.pageBreak=function(){var n=t.createElement("P");return n.className="rte-page-break",{exec:function(t){var a,r=t.selection.getSelectedNode();r=e.dom.getParentElement(r,{query:"*"},null,t.editableArea),r?(t.selection.splitElementAtCaret(r,n),t.selection.selectNode(n.nextSibling||n),a=t.selection.getSelection(),a.collapseToStart()):t.selection.insertHTML('<p class="rte-page-break"></p>')}}}(),n.insertImage=function(){var t="IMG";return{exec:function(n,a,r){r="object"==typeof r?r:{src:r};var i,o,l=n.doc,s=this.state(n);if(s&&!r.src)return n.selection.setBefore(s),o=s.parentNode,o.removeChild(s),e.dom.removeEmptyTextNodes(o),"A"!==o.nodeName||o.firstChild||(n.selection.setAfter(o),o.parentNode.removeChild(o)),void e.quirks.redraw(n.element);if(s)for(var c in r)r.hasOwnProperty(c)&&s.setAttribute("className"===c?"class":c,r[c]);else{s=l.createElement(t),s.onclick=function(){this.width=this.offsetWidth,this.height=this.offsetHeight};for(var d in r)s.setAttribute("className"===d?"class":d,r[d]);n.selection.insertNode(s),e.browser.hasProblemsSettingCaretAfterImg()?(i=l.createTextNode(e.INVISIBLE_SPACE),n.selection.insertNode(i),n.selection.setAfter(i)):n.selection.setAfter(s)}},state:function(n){var a,r,i,o=n.doc;return e.dom.hasElementWithTagName(o,t)&&(a=n.selection.getSelectedNode())?a.nodeName===t?a:a.nodeType!==e.ELEMENT_NODE?!1:(r=n.selection.getText(),(r=e.lang.string(r).trim())?!1:(i=n.selection.getNodes(e.ELEMENT_NODE,function(e){return e.nodeName===t}),1!==i.length?!1:i[0])):!1}}}(),n.source=function(){return{exec:function(){var e,n=t.body.classList;n.toggle("rte-source-is-visible"),e=n.contains("rte-source-is-visible")?1:0,localStorage.setItem("rte_source_is_visible",e)}}}()}(wysihtml);var RTE=function(e,t){function n(e){return"function"==typeof e}function a(e){return"object"==typeof e}function r(e,t,a){return t="on"+t,null===a?e[t]=null:(n(e[t])&&(a=function(e,t){return function(){return e.apply(this,arguments),t.apply(this,arguments)}}(e[t],a)),void(e[t]=a))}function i(e,t){e=e||{};for(var n in t)e[n]=a(t[n])?i(e[n],t[n]):t[n];return e}function o(e){return e.replace(/^\s+|\s+$/g,"")}function l(e){return e.replace(/\s*<br *\/?>\s*(<\/.+?>)/g,"$1").replace(/<p>\s*<\/p>/g,"<p>&nbsp;</p>").replace(/<([^<>\s]+?)(?:>| .*?>)([^<>]*?)<\/([^<>\s]+?)>/g,function(e,t,n,a){return t!==a?e:""===n.replace(/<.*?>/g,"")?"":e}).replace(/\s*(<(?:\/.+?|.+? *\/?)>)\s*(?=<)/g,"$1\n").replace(/<[^\/]+?>/g,function(e){return e.replace(/ alt=(""|\'\')/g,' alt=" "').replace(/ [\w:-]+=(?:""|\'\')/g,"").replace(/ alt=" "/g,' alt=""')}).replace(/\n*(<\/?(?:a|abbr|b|cite|code|del|dfn|em|img|ins|mark|q|s|span|su[bp]|strong|time|u)(?:>| .*?>))\n*/g,"$1").replace(/\s*<br *\/?>\s*/g,"<br>\n").replace(/^\s*<[^\/<>]+?>\s*(\{\{(.+?)\}\})\s*<\/[^<>]+?>\s*$/gm,"$1").replace(/^(\s*<p>&nbsp;<\/p>\s*)+|(\s*<p>&nbsp;<\/p>\s*)+$/g,"")}function s(){var t=this;clearTimeout(u),u=setTimeout(function(){var n=o(t.getValue(!1).replace(/\s*<p class="rte-page-break">(.*?)<\/p>\s*/g,"\n<!-- cut$1 -->\n"));e.value=l(n).replace(d,"\n$1\n")},500)}function c(){var e=this;clearTimeout(p),p=setTimeout(function(){H.setValue(e.value.replace(d,'<p class="rte-page-break">$1</p>'),!1)},500)}var d=/(<!--\s*cut(\+(?:\s+.*?)?)?\s*-->)/g,u=null,p=null,m="data-wysihtml-",f=document,g={check_attributes:{"class":"any",id:"any",title:"any",style:"any",border:"numbers",width:"numbers",height:"numbers",colspan:"numbers",rowspan:"numbers",datetime:"any",target:"any",href:"any",alt:"any",src:"any",cite:"any"}},h={dir:"ltr",wysihtml:{useLineBreaks:!1,classNames:{body:"rte-is-active",composer:"rte-area",sandbox:"rte-area",placeholder:"rte-placeholder"},parserRules:{tags:{strong:g,b:g,i:g,u:g,s:g,q:g,em:g,strike:{rename_tag:"s"},mark:g,abbr:g,dfn:g,del:g,ins:g,time:g,sup:g,sub:g,pre:g,code:g,h1:g,h2:g,h3:g,h4:g,h5:g,h6:g,blockquote:g,hr:g,comments:1,br:g,p:g,div:g,span:g,ul:g,ol:g,li:g,dl:g,dt:g,dd:g,a:g,table:g,thead:g,tbody:g,tfoot:g,tr:g,th:g,td:g,caption:g,img:g,figure:g,figcaption:g,section:g,header:g,nav:g,footer:g}}}},v=i(h,t),b=f.createElement("div");b.setAttribute("data-placeholder","placeholder"in e?e.placeholder:""),setTimeout(function(){var t=e.cloneNode();t.style.display="block",t.style.position="absolute",t.style.top="-9999px",f.body.appendChild(t);var n=t.offsetHeight+"px";b.style.minHeight=n,f.body.removeChild(t),b.innerHTML=e.value},1);var y=f.createElement("div");y.className="rte-toolbar";var N=RegExp("(^|\\s)rte-source(\\s|$)"),k=e.className,E=e.parentNode;k.match(N)||(e.className=o(k+" rte-source")),E.insertBefore(b,e),E.insertBefore(y,b);var x={bold:["Bold","bold"],italic:["Italic","italic"],underline:["Underline","underline"],strike:["Strike Through","strike"],sup:["Superscript","sup"],sub:["Subscript","sub"],quote:["Quote","quote"],"list-ol":["Ordered List","insertOrderedList"],"list-ul":["Unordered List","insertUnorderedList"],"align-left":["Align Left","alignLeft"],"align-center":["Align Center","alignCenter"],"align-right":["Align Right","alignRight"],"align-justify":["Align Justify","alignJustify"],horizontal:["Horizontal Rule","horizontal"],format:["Format",{Normal:"p","Header 1":"h1","Header 2":"h2","Header 3":"h3","Header 4":"h4","Header 5":"h5","Header 6":"h6","Code Snippet":{":command":"pre",":command-value":"no-highlight"}}],image:["Image","insertImage"],link:["Link","createLink"],unlink:["Remove Link","removeLink"],clean:["Remove Format","removeFormat"],"break":["Insert Jump Break","pageBreak"],undo:["Undo","undo"],redo:["Redo","redo"],source:["HTML Source","source"]};for(var T in x){var C=x[T][1],L=f.createElement(a(C)?"span":"a"),S=x[T][0];if(L.className="rte-toolbar-button rte-toolbar-button-"+T,S&&(L.title=S),L.href="javascript:;",L.innerHTML='<i class="icon icon-'+T+'"></i>',a(C)){var A="<span>";for(var T in C)if(a(C[T])){A+='<a href="javascript:;"';var w=C[T];for(var B in w)A+=" "+B.replace(":",m)+'="'+w[B]+'"';A+=">"+T+"</a>"}else A+='<a href="javascript:;" '+m+'command="formatBlock" '+m+'command-value="'+C[T]+'">'+T+"</a>";L.innerHTML+=A,L.children[0].onclick=function(){this.nextSibling.style.display="block"},L.children[1].onmouseup=function(){var e=this;e.style.display="none",setTimeout(function(){e.style.display=""},1)}}else L.setAttribute(m+"command",C);y.appendChild(L)}var R=f.createElement("div");R.innerHTML='<div class="rte-prompt" '+m+'dialog="createLink" style="display:none;"><label><span>Link</span><input type="text" '+m+'dialog-field="href" value="http://"></label><label><span>Title</span><input type="text" '+m+'dialog-field="title" value=""></label><span class="rte-prompt-action"><a '+m+'dialog-action="save" href="javascript:;">OK</a><a '+m+'dialog-action="cancel" href="javascript:;">Cancel</a></span></div><div class="rte-prompt" '+m+'dialog="insertImage" style="display:none;"><input type="hidden" '+m+'dialog-field="width" value=""><input type="hidden" '+m+'dialog-field="height" value=""><label><span>Source</span><input type="text" '+m+'dialog-field="src" value="http://"></label><label><span>Text</span><input type="text" '+m+'dialog-field="alt" value=""></label><label><span>Title</span><input type="text" '+m+'dialog-field="title" value=""></label><label><span>Align</span><select '+m+'dialog-field="class"><option value="">&mdash; None &mdash;</option><option value="align-left">Left</option><option value="align-center">Center</option><option value="align-right">Right</option></select></label><span class="rte-prompt-action"><a '+m+'dialog-action="save" href="javascript:;">OK</a><a '+m+'dialog-action="cancel" href="javascript:;">Cancel</a></span></div>',y.appendChild(R),v.wysihtml.toolbar=y;var H=new wysihtml.Editor(b,v.wysihtml);H.on("interaction:composer",s),H.on("aftercommand:composer",s),r(e,"input",c),r(e,"keyup",c),r(e,"focus",c),r(e,"blur",c);var I=localStorage.getItem("rte_source_is_visible");+I&&f.body.classList.add("rte-source-is-visible")};!function(e,t){for(var n=t.querySelectorAll(".MTE:not(.MTE-ignore)"),a=0,r=n.length;r>a;++a)"textarea"===n[a].nodeName.toLowerCase()&&new RTE(n[a])}(window,document);