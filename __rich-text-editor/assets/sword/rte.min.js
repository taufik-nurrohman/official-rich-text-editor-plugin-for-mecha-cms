/*! Taufik Nurrohman <http://latitudu.com> (2016-05-30) */
!function(e){for(var t=document,a=e.commands,n=["Left","Center","Right","Justify"],r=0,i=n.length;i>r;++r)a["align"+n[r]]=function(){var e={className:"text-"+n[r].toLowerCase(),classRegExp:/text-[a-z0-9]+/g,toggle:!0};return{exec:function(t){return a.formatBlock.exec(t,"formatBlock",e)},state:function(t){return a.formatBlock.state(t,"formatBlock",e)}}}();var o={bold:"STRONG",italic:"EM",underline:"U",strike:"DEL",time:"TIME",code:"CODE",mark:"MARK",sup:"SUP",sub:"SUB"};for(var r in o)a[r]=function(){var e={nodeName:o[r],attribute:{},toggle:!0};return{exec:function(t,n){if(n.match(/^del|ins|strike|time$/)){var r=new Date,i=+r.getFullYear(),o=+r.getMonth()+1,l=+r.getDate();10>o&&(o="0"+o),10>l&&(l="0"+l),e.attribute.datetime=i+"-"+o+"-"+l}a.formatInline.exec(t,n,e)},state:function(t,n){return a.formatInline.state(t,n,e)}}}(),a.pre=function(){return{exec:function(t,a,n){var r,i,o,l=this.state(t)[0];l?t.selection.executeAndRestore(function(){r=l.querySelector("code"),e.dom.replaceWithChildNodes(l),r&&e.dom.replaceWithChildNodes(r)}):(i=t.selection.getRange(),o=i.extractContents(),l=t.doc.createElement("PRE"),r=t.doc.createElement("CODE"),n&&(r.className=n),l.appendChild(r),r.appendChild(o),i.insertNode(l),t.selection.selectNode(l))},state:function(t){var a,n=t.selection.getSelectedNode();return n&&n.nodeName&&"PRE"==n.nodeName&&n.firstChild&&n.firstChild.nodeName&&"CODE"==n.firstChild.nodeName?[n]:(a=e.dom.getParentElement(n,{query:"pre code"}),a?[a.parentNode]:!1)}}}(),a.quote=function(){var e={nodeName:"BLOCKQUOTE",toggle:!0};return{exec:function(t){return a.formatBlock.exec(t,"formatBlock",e)},state:function(t){return a.formatBlock.state(t,"formatBlock",e)}}}(),a.horizontal=function(){return{exec:function(t){var a,n,r=t.selection.getSelectedNode();(r=e.dom.getParentElement(r,{query:"*"},null,t.editableArea))?(a=t.doc.createElement("HR"),t.selection.splitElementAtCaret(r,a),t.selection.selectNode(a.nextSibling||a),n=t.selection.getSelection(),n.collapseToStart()):t.selection.insertHTML("<hr>")}}}(),a.pageBreak=function(){var a=t.createElement("P");return a.className="rte-page-break",{exec:function(t){var n,r=t.selection.getSelectedNode();r=e.dom.getParentElement(r,{query:"*"},null,t.editableArea),r?(t.selection.splitElementAtCaret(r,a),t.selection.selectNode(a.nextSibling||a),n=t.selection.getSelection(),n.collapseToStart()):t.selection.insertHTML('<p class="rte-page-break"></p>')}}}(),a.insertImage=function(){var t="IMG";return{exec:function(a,n,r){r="object"==typeof r?r:{src:r};var i,o,l=a.doc,s=this.state(a);if(s&&!r.src)return a.selection.setBefore(s),o=s.parentNode,o.removeChild(s),e.dom.removeEmptyTextNodes(o),"A"!==o.nodeName||o.firstChild||(a.selection.setAfter(o),o.parentNode.removeChild(o)),void e.quirks.redraw(a.element);if(s)for(var c in r)r.hasOwnProperty(c)&&s.setAttribute("className"===c?"class":c,r[c]);else{s=l.createElement(t),s.onclick=function(){this.width=this.offsetWidth,this.height=this.offsetHeight};for(var d in r)s.setAttribute("className"===d?"class":d,r[d]);a.selection.insertNode(s),e.browser.hasProblemsSettingCaretAfterImg()?(i=l.createTextNode(e.INVISIBLE_SPACE),a.selection.insertNode(i),a.selection.setAfter(i)):a.selection.setAfter(s)}},state:function(a){var n,r,i,o=a.doc;return e.dom.hasElementWithTagName(o,t)&&(n=a.selection.getSelectedNode())?n.nodeName===t?n:n.nodeType!==e.ELEMENT_NODE?!1:(r=a.selection.getText(),(r=e.lang.string(r).trim())?!1:(i=a.selection.getNodes(e.ELEMENT_NODE,function(e){return e.nodeName===t}),1!==i.length?!1:i[0])):!1}}}(),a.source=function(){return{exec:function(){var e,a=t.body.classList;a.toggle("rte-source-is-visible"),e=a.contains("rte-source-is-visible")?1:0,localStorage.setItem("rte_source_is_visible",e)}}}()}(wysihtml);var RTE=function(e,t){function a(e){return"function"==typeof e}function n(e){return"object"==typeof e}function r(e,t,n){return t="on"+t,null===n?e[t]=null:(a(e[t])&&(n=function(e,t){return function(){return e.apply(this,arguments),t.apply(this,arguments)}}(e[t],n)),void(e[t]=n))}function i(e,t){e=e||{};for(var a in t)e[a]=n(t[a])?i(e[a],t[a]):t[a];return e}function o(e){return e.replace(/^\s+|\s+$/g,"")}function l(e){return e.replace(/\s*<br *\/?>\s*(<\/.+?>)/g,"$1").replace(/<p>\s*<\/p>/g,"<p>&nbsp;</p>").replace(/<([^<>\s]+?)(?:>| .*?>)<\/([^<>\s]+?)>/g,"").replace(/\s*(<(?:\/.+?|.+? *\/?)>)\s*(?=<)/g,"$1\n").replace(/<[^\/]+?>/g,function(e){return e.replace(/ alt=(""|\'\')/g,' alt=" "').replace(/ [\w:-]+=(?:""|\'\')/g,"").replace(/ alt=" "/g,' alt=""')}).replace(/\n*(<\/?(?:a|abbr|b|cite|code|del|dfn|em|img|ins|mark|q|s|span|su[bp]|strong|time|u)(?:>| .*?>))\n*/g,"$1").replace(/\s*<br *\/?>\s*/g,"<br>\n").replace(/^\s*<[^\/<>]+?>\s*(\{\{(.+?)\}\})\s*<\/[^<>]+?>\s*$/gm,"$1").replace(/^(\s*<p>&nbsp;<\/p>\s*)+|(\s*<p>&nbsp;<\/p>\s*)+$/g,"")}function s(){var t=this;clearTimeout(u),u=setTimeout(function(){var a=o(t.getValue(!1).replace(/\s*<p class="rte-page-break">(.*?)<\/p>\s*/g,"\n<!-- cut$1 -->\n"));e.value=l(a).replace(d,"\n$1\n")},500)}function c(){var e=this;clearTimeout(p),p=setTimeout(function(){H.setValue(e.value.replace(d,'<p class="rte-page-break">$1</p>'),!1)},500)}var d=/(<!--\s*cut(\+(?:\s+.*?)?)?\s*-->)/g,u=null,p=null,m="data-wysihtml-",f=document,g={check_attributes:{"class":"any",id:"any",title:"any",style:"any",border:"numbers",width:"numbers",height:"numbers",colspan:"numbers",rowspan:"numbers",datetime:"any",target:"any",href:"any",alt:"any",src:"any",cite:"any"}},h={dir:"ltr",wysihtml:{useLineBreaks:!1,classNames:{body:"rte-is-active",composer:"rte-area",sandbox:"rte-area",placeholder:"rte-placeholder"},parserRules:{tags:{strong:g,b:g,i:g,u:g,s:g,q:g,em:g,strike:{rename_tag:"s"},mark:g,abbr:g,dfn:g,del:g,ins:g,time:g,sup:g,sub:g,pre:g,code:g,h1:g,h2:g,h3:g,h4:g,h5:g,h6:g,blockquote:g,hr:g,comments:1,br:g,p:g,div:g,span:g,ul:g,ol:g,li:g,dl:g,dt:g,dd:g,a:g,table:g,thead:g,tbody:g,tfoot:g,tr:g,th:g,td:g,caption:g,img:g,figure:g,figcaption:g,section:g,header:g,nav:g,footer:g}}}},v=i(h,t),b=f.createElement("div");b.setAttribute("data-placeholder","placeholder"in e?e.placeholder:""),setTimeout(function(){var t=e.cloneNode();t.style.display="block",t.style.position="absolute",t.style.top="-9999px",f.body.appendChild(t);var a=t.offsetHeight+"px";b.style.minHeight=a,f.body.removeChild(t),b.innerHTML=e.value},1);var y=f.createElement("div");y.className="rte-toolbar";var N=RegExp("(^|\\s)rte-source(\\s|$)"),k=e.className,E=e.parentNode;k.match(N)||(e.className=o(k+" rte-source")),E.insertBefore(b,e),E.insertBefore(y,b);var x={bold:["Bold","bold"],italic:["Italic","italic"],underline:["Underline","underline"],strike:["Strike Through","strike"],sup:["Superscript","sup"],sub:["Subscript","sub"],quote:["Quote","quote"],"list-ol":["Ordered List","insertOrderedList"],"list-ul":["Unordered List","insertUnorderedList"],"align-left":["Align Left","alignLeft"],"align-center":["Align Center","alignCenter"],"align-right":["Align Right","alignRight"],"align-justify":["Align Justify","alignJustify"],horizontal:["Horizontal Rule","horizontal"],format:["Format",{Normal:"p","Header 1":"h1","Header 2":"h2","Header 3":"h3","Header 4":"h4","Header 5":"h5","Header 6":"h6","Code Snippet":{":command":"pre",":command-value":"no-highlight"}}],image:["Image","insertImage"],link:["Link","createLink"],unlink:["Remove Link","removeLink"],clean:["Remove Format","removeFormat"],"break":["Insert Jump Break","pageBreak"],undo:["Undo","undo"],redo:["Redo","redo"],source:["HTML Source","source"]};for(var T in x){var C=x[T][1],L=f.createElement(n(C)?"span":"a"),S=x[T][0];if(L.className="rte-toolbar-button rte-toolbar-button-"+T,S&&(L.title=S),L.href="javascript:;",L.innerHTML='<i class="icon icon-'+T+'"></i>',n(C)){var A="<span>";for(var T in C)if(n(C[T])){A+='<a href="javascript:;"';var w=C[T];for(var B in w)A+=" "+B.replace(":",m)+'="'+w[B]+'"';A+=">"+T+"</a>"}else A+='<a href="javascript:;" '+m+'command="formatBlock" '+m+'command-value="'+C[T]+'">'+T+"</a>";L.innerHTML+=A,L.children[0].onclick=function(){this.nextSibling.style.display="block"},L.children[1].onmouseup=function(){var e=this;e.style.display="none",setTimeout(function(){e.style.display=""},1)}}else L.setAttribute(m+"command",C);y.appendChild(L)}var R=f.createElement("div");R.innerHTML='<div class="rte-prompt" '+m+'dialog="createLink" style="display:none;"><label><span>Link</span><input type="text" '+m+'dialog-field="href" value="http://"></label><label><span>Title</span><input type="text" '+m+'dialog-field="title" value=""></label><span class="rte-prompt-action"><a '+m+'dialog-action="save" href="javascript:;">OK</a><a '+m+'dialog-action="cancel" href="javascript:;">Cancel</a></span></div><div class="rte-prompt" '+m+'dialog="insertImage" style="display:none;"><input type="hidden" '+m+'dialog-field="width" value=""><input type="hidden" '+m+'dialog-field="height" value=""><label><span>Source</span><input type="text" '+m+'dialog-field="src" value="http://"></label><label><span>Text</span><input type="text" '+m+'dialog-field="alt" value=""></label><label><span>Title</span><input type="text" '+m+'dialog-field="title" value=""></label><label><span>Align</span><select '+m+'dialog-field="class"><option value="">&mdash; None &mdash;</option><option value="align-left">Left</option><option value="align-center">Center</option><option value="align-right">Right</option></select></label><span class="rte-prompt-action"><a '+m+'dialog-action="save" href="javascript:;">OK</a><a '+m+'dialog-action="cancel" href="javascript:;">Cancel</a></span></div>',y.appendChild(R),v.wysihtml.toolbar=y;var H=new wysihtml.Editor(b,v.wysihtml);H.on("interaction:composer",s),H.on("aftercommand:composer",s),r(e,"input",c),r(e,"keyup",c),r(e,"focus",c),r(e,"blur",c);var I=localStorage.getItem("rte_source_is_visible");+I&&f.body.classList.add("rte-source-is-visible")};!function(e,t){for(var a=t.querySelectorAll(".MTE:not(.MTE-ignore)"),n=0,r=a.length;r>n;++n)"textarea"===a[n].nodeName.toLowerCase()&&new RTE(a[n])}(window,document);